<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tic-Tac-Toe</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="msg-container hide">
      <p id="msg1"></p>
      <button id="new-btn">New Game</button>
    </div>
    <main>
      <h1>Tic-Tac-Toe</h1>
      <div class="container">
        <div class="game">
          <button class="box"></button>
          <button class="box"></button>
          <button class="box"></button>
          <button class="box"></button>
          <button class="box"></button>
          <button class="box"></button>
          <button class="box"></button>
          <button class="box"></button>
          <button class="box"></button>
        </div>
      </div>
      <button id="reset-btn">Reset Game</button>
      <script>
        let boxes = document.querySelectorAll(".box");
        let resetbtn = document.querySelector("#reset-btn");
        let newbtn = document.querySelector("#new-btn");
        let msgcontainer = document.querySelector(".msg-container");
        let msg = document.querySelector("#msg1");

        let turn0 = true;
        const winpattern = [
          [0, 1, 2],
          [0, 3, 6],
          [0, 4, 8],
          [1, 4, 7],
          [2, 5, 8],
          [2, 4, 6],
          [3, 4, 5],
          [6, 7, 8],
        ];
        var c = 0;
        boxes.forEach(khem);
        function khem(box) {
          box.addEventListener("click", () => {
            if (turn0 === true) {
              box.innerHTML = "O";
              turn0 = false;
            } else {
              box.innerHTML = "X";
              turn0 = true;
            }
            box.disabled = true;
            checkwinner();
            c = c + 1;
            if (c != 9) {
              checkwinner();
            } else {
              var ishan = checkwinner1();
              console.log(ishan);
              if (ishan == 1) {
                checkdraw();
              }
              console.log(c);
            }
          });
        }
        function checkdraw() {
          msg.innerText = `Its a draw`;
          msgcontainer.classList.remove("hide");
        }
        function showwinner(winner) {
          msg.innerText = `Congratulations, Winner is ${winner}`;
          msgcontainer.classList.remove("hide");
        }
        function resetgame() {
          c = 0;
          turn0 = true;
          enableboxes();
          msgcontainer.classList.add("hide");
        }
        function enableboxes() {
          for (let box of boxes) {
            box.disabled = false;
            box.innerHTML = "";
          }
        }
        function checkwinner() {
          for (let pattern of winpattern) {
            let p1 = boxes[pattern[0]].innerText;
            let p2 = boxes[pattern[1]].innerText;
            let p3 = boxes[pattern[2]].innerText;
            if (p1 != "" && p2 != "" && p3 != "") {
              if (p1 == p2 && p2 == p3) {
                showwinner(p1);
              }
            }
          }
        }
        function checkwinner1() {
          for (let pattern of winpattern) {
            let p1 = boxes[pattern[0]].innerText;
            let p2 = boxes[pattern[1]].innerText;
            let p3 = boxes[pattern[2]].innerText;
            if (p1 != "" && p2 != "" && p3 != "") {
              if (p1 == p2 && p2 == p3) {
                showwinner(p1);
              }
            } else {
              return 1;
            }
          }
        }
        newbtn.addEventListener("click", resetgame);
        resetbtn.addEventListener("click", resetgame);

        console.log("Hello");
      </script>
    </main>
  </body>
</html>
